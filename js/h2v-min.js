/* h2v.js version 1.3.4    last modified at Aug 08 2011    (c)tyz@freefielder.jp     For detail , please visit http://freefielder.jp/tate/h2v/    ** Don't remove this copyright message ***/var h2vconvert={version:"1.3.4",target:new Object(),defaultval:{auto:true,chars:25,fontsize:"16px",lineInterval:0.4,rotate:true,bar:true,showcredit:true},defaultFontFamily:"'ヒラギノ角ゴ Pro W3','Hiragino Kaku Gothic Pro','Hiragino Kaku Gothic Pro W3' ,'メイリオ' , 'Meiryo' , 'ＭＳ ゴシック','MS Gothic' ,'TakaoGothic' , 'Takaoゴシック' , monospace",lineInterval:0,lineSpace:0,mL:0,mR:0,defaultFS:0,currentH:0,tmpdiv:"",isOpera:false,isOld:false,isIE:false,isIE8:false,isWKold:false,blocks:new Array("DIV","UL","OL","DL","P","BLOCKQUOTE","H1","H2","H3","H4","H5","H6","CENTER"),lists:new Array("LI","DT","DD"),inlines:new Array("FONT","STRONG","BIG","SMALL","I","B","EM","SUB","SUP","A","RUBY","RT","RB"),thrus:new Array("PRE","IFRAME","TABLE","TEXTAREA"),init:function(e){var c=navigator.userAgent.toLowerCase();var a=window.opera?(opera.version().replace(/\d$/,"")-0):parseFloat((/(?:ie |fox\/|ome\/|ion\/)(\d+\.\d)/.exec(c)||[,0])[1]);if(/opera/.test(c)){h2vconvert.isOpera=true}this.isOld=false;if((/opera/.test(c)&&a<10.5)||(/firefox/.test(c)&&a<3.5)||((!/chrome/.test(c)&&/safari/.test(c)&&!/mobile/.test(c))&&a<3)||(/msie/.test(c)&&a<8)){this.isOld=true}if(/msie/.test(c)){h2vconvert.isIE=true}if(/msie/.test(c)&&a<9){h2vconvert.isIE8=true}if(/safari/.test(c)&&a<5){h2vconvert.isWKold=true}if(document.addEventListener){if(!/safari/.test(c)){document.addEventListener("DOMContentLoaded",function(){h2vconvert.startConvert(e)},false)}else{window.addEventListener("load",function(){h2vconvert.startConvert(e)},false)}}else{if(/msie/.test(c)){try{document.documentElement.doScroll("left")}catch(b){setTimeout(function(){h2vconvert.init(e)},0);return}h2vconvert.startConvert(e)}else{window.onload=function(){h2vconvert.startConvert(e)}}}},startConvert:function(f){var b=navigator.userAgent.toLowerCase();if(/mobile/.test(b)&&/safari/.test(b)){document.body.style.webkitTextSizeAdjust="none"}for(var h in f){this.target[h]=new this.h2v(f,h)}for(var h in this.target){var g=this.target[h];var a=tyz.getById(h);if(g.auto&&!tyz.getByClass(a,"h2v").length){try{this.convert(h)}catch(c){a.style.fontSize=g.originalFontSize;a.style.fontFamily=g.originalFontFamily;a.innerHTML=g.original;var e=tyz.newEle("DIV",{"class":"h2v_bar"},{width:g.pagewidth});e.innerHTML='<a href="http://freefielder.jp/tate/h2v/" target="_blank">縦書き変換</a>に失敗しました。';tyz.getById(h).insertBefore(e,tyz.getById(h).firstChild)}a.style.visibility="visible"}else{a.style.fontFamily=g.originalFontFamily;a.style.fontSize=g.originalFontSize}}},convert:function(a){var h=this.target[a];var o=tyz.getById(a);if(this.isOld){if(tyz.getByClass(a,"h2v_bar").length==0){var n=tyz.newEle("DIV",{"class":"h2v_bar"});n.innerHTML='!! <a href="http://freefielder.jp/tate/h2v/" target="_blank">最新のブラウザでは、縦書きでも閲覧できます。</a>';o.insertBefore(n,o.firstChild)}return false}o.style.fontFamily=this.defaultFontFamily;o.style.fontSize=h.fontsize;this.defaultFS=tyz.PX(h.fontsize);this.lineInterval=this.defaultFS*h.lineInterval;this.lineSpace=this.lineInterval/2;this.mL=0;this.mR=0;this.currentH=0;o.innerHTML=o.innerHTML.replace(/[\n\r\t]/g,"");this.rotateProperties(o);o.normalize();var c=this.extractNodeContents(o);this.addVTags(c);o.appendChild(c);o.style.whiteSpace="nowrap";this.setHWStyle(a,"h2v_alpha");this.setHWStyle(a,"h2v_sp");o.style.whiteSpace="normal";h.html=this.extractNodeContents(o);var p=h.html;this.lineW=this.defaultFS;var q=this.target[a].chars*this.defaultFS;this.tmpdiv=this.createTmpdiv(a);var t=this.separateLines(a,p,this.defaultFS,q);var m=tyz.newEle("div",{"class":"h2v"},{position:"absolute",left:"0px"});for(var f=0;f<t.length;f++){m.appendChild(t[f])}h.converted=m.cloneNode(true);var b=this.separatePages(a,m);var k=tyz.newEle("DIV",{"class":"h2v"},{fontSize:h.fontsize});if(h.bar){var g=tyz.newEle("DIV",{"class":"h2v_bar"});g.innerHTML='<a href="#" onclick="h2vconvert.switcher( \''+a+"');\">縦→横切替</span>";k.appendChild(g)}for(var j=0;j<b.length;j++){var r=q*1+this.defaultFS*1;var e=tyz.newEle("DIV",{"class":"h2v_page"},{clear:"both",minHeight:r+"px"});var s=tyz.newEle("DIV",{"class":"h2v_separator"},{width:h.pagewidth});e.appendChild(b[j]);k.appendChild(e);k.appendChild(s)}k.removeChild(k.lastChild);if(h.showcredit){var g=tyz.newEle("DIV",{"class":"h2v_bar"},{width:h.pagewidth,marginTop:"10px"});g.innerHTML='<a href="http://freefielder.jp/tate/h2v/" target="_blank">h2v.js ver'+this.version+"</a>";k.appendChild(g)}h.pages=k.cloneNode(true);o.appendChild(k);o.appendChild(tyz.newEle("DIV",{"class":"clearfix"}));this.removeTmpdiv("h2v_tmp_div")},setHWStyle:function(h,b){var f=tyz.getByClass(h,b);for(var c=0;c<f.length;c++){if(this.isIE8){tyz.setStyles(f[c],{filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)",fontFamily:"'ＭＳ ゴシック','MS Gothic' , monospace"})}var e=f[c].offsetWidth;var a=tyz.getStyle(f[c]).fontSize;var g=e-tyz.PX(a);if(g<0){g=b=="h2v_alpha"?g:e}tyz.setStyles(f[c],{width:e+"px",marginBottom:g+"px"})}},separateLines:function(h,a,e,f){var b=new Array();var g;var c;while(g=this.seekNodes(h,a,e,f)){if((this.isBlock(g)||this.isList(g))&&tyz.PX(g.style.width)==0){b[b.length]=this.extractRange(a,g)}else{this.mL=this.mL*1+this.lineSpace*1;this.mR=this.mR*1+this.lineSpace*1;c=tyz.newEle("DIV",{"class":"h2v_e"},{marginLeft:tyz.round(this.mL,2)+"px",marginRight:tyz.round(this.mR,2)+"px"});c.appendChild(this.extractRange(a,g));b[b.length]=c}this.mL=0;this.mR=0;this.lineW=this.defaultFS;this.currentH=0}this.mL=this.mL*1+this.lineSpace*1;this.mR=this.mR*1+this.lineSpace*1;c=tyz.newEle("DIV",{"class":"h2v_e"},{marginLeft:tyz.round(this.mL,2)+"px",marginRight:tyz.round(this.mR,2)+"px"});if(a.hasChildNodes()){c.appendChild(this.extractNodeContents(a));b[b.length]=c}return b},seekNodes:function(s,w,D,v){var j;var g;var A;var b;var z=this.target[s].html;var o=this.tmpdiv;if(!this.isIE8){w.normalize()}for(var y=0;y<w.childNodes.length;y++){j=w.childNodes[y];g=j.style;A=j.nodeName;if(A=="#text"&&!j.nodeValue.match(/[!-;=-~]+\s?/g)){b=this.currentH;var l=D*j.length;var t=v-b;if(t*1<=0){t=0}if(tyz.ceil(t,2)<=tyz.floor(l,2)){var c=tyz.floor(t/D,0);if(c==0){var x=j.previousSibling||j.parentNode.previousSibling||j.parentNode}else{if(c<j.length){var E=j.splitText(c);var x=j}else{var x=j}}if(x.nextSibling){var E=x.nextSibling;if(E.nodeName=="SPAN"&&(tyz.getAttr(E,"class")=="h2v_kuto")){return E}}return x}this.currentH=this.currentH*1+l*1}else{if(A=="SPAN"&&(tyz.getAttr(j,"class")=="h2v_alpha"||tyz.getAttr(j,"class")=="h2v_sp")){var l=(tyz.PX(g.marginBottom)*1+D*1);var l=tyz.PX(g.width);b=this.currentH;var t=v-b;if(t<tyz.PX(g.width)*1){if(v<tyz.PX(g.width)*1){return j}else{if(j.previousSibling){return j.previousSibling}else{return j.parentNode}}}this.currentH=this.currentH*1+l*1}else{if(this.isInline(j)||(A=="SPAN"&&!tyz.getAttr(j,"class").match(/h2v_/g))){var h=tyz.PX(g.fontSize);var n=(tyz.PX(g.marginTop)*1+tyz.PX(g.marginBottom)*1+tyz.PX(g.paddingTop)*1+tyz.PX(g.paddingBottom)*1+tyz.PX(g.borderTopWidth)*1+tyz.PX(g.borderBottomWidth)*1);var C=v-n;if(C<=0){C=h}this.setLineMargin(h);this.currentH=this.currentH*1+n*1;var B=this.seekNodes(s,j,h,C);if(B){return B}}else{if(this.isBlock(j)||this.isList(j)){var h=tyz.PX(g.fontSize);var n=(tyz.PX(g.marginTop)*1+tyz.PX(g.marginBottom)*1+tyz.PX(g.paddingTop)*1+tyz.PX(g.paddingBottom)*1+tyz.PX(g.borderTopWidth)*1+tyz.PX(g.borderBottomWidth)*1);var q=this.getDisplayedStyle(j,{width:"",height:"",marginLeft:"",marginRight:"",paddingLeft:"",paddingRight:"",borderLeftWidth:"",borderRightWidth:""},false);var f=tyz.PX(q.width);var p=tyz.PX(q.height);if(f!=0&&p!=0){j.style.height=f+"px";v=f;n=0;j.style.width=p*1<tyz.PX(this.target[s].pagewidth)?p+"px":"auto"}else{if(f!=0){j.style.height=f+"px";v=f;n=0;j.style.width="auto"}else{if(p!=0){j.style.width=p*1<tyz.PX(this.target[s].pagewidth)?p+"px":"auto";j.style.height="auto"}}}var C=v-n;if(C<=0){C=h}this.setLineMargin(h);var a=this.separateLines(s,j,h,C);for(var m=0;m<a.length;m++){j.appendChild(a[m])}if(A=="LI"){var k=tyz.newEle("SPAN",{"class":"h2v_mark"});k.appendChild(document.createTextNode("・"));j.firstChild.insertBefore(k,j.firstChild.firstChild)}if(tyz.PX(j.style.width)!=0){var e=tyz.PX(j.style.width)-this.defaultFS+tyz.PX(q.paddingLeft)*1+tyz.PX(q.paddingRight)*1+tyz.PX(q.borderLeftWidth)*1+tyz.PX(q.borderRightWidth)*1+tyz.PX(q.marginLeft)*1;j.style.position="relative";j.style.left=e+"px";this.mR=e+tyz.PX(q.marginRight)*1-tyz.PX(q.marginLeft)*1;this.mL=tyz.PX(q.marginLeft)*1+tyz.PX(q.paddingLeft)*1}return j}else{if(this.isThru(j)){var q=this.getDisplayedStyle(j,{width:"",marginLeft:"",marginRight:"",paddingLeft:"",paddingRight:"",borderLeftWidth:"",borderRightWidth:""},true);this.tmpdiv.appendChild(j.cloneNode(true));var r=this.tmpdiv.lastChild.offsetWidth+"px";this.tmpdiv.removeChild(this.tmpdiv.lastChild);var e=tyz.PX(r)-this.defaultFS+tyz.PX(q.paddingLeft)*1+tyz.PX(q.paddingRight)*1+tyz.PX(q.borderLeftWidth)*1+tyz.PX(q.borderRightWidth)*1;g.left=tyz.floor(e,2)+"px";this.mR=e+tyz.PX(q.marginRight)*1;this.mL=tyz.PX(q.marginLeft)*1+tyz.PX(q.paddingLeft)*1;g.width=r;return j}else{if(A=="IMG"){var q=this.getDisplayedStyle(j,{width:"",height:"",marginLeft:"",marginRight:"",paddingLeft:"",paddingRight:"",paddingTop:"",paddingBottom:"",borderLeftWidth:"",borderRightWidth:""},false);if(this.isIE8){this.tmpdiv.appendChild(j.cloneNode(true));q.width=this.tmpdiv.lastChild.offsetWidth+"px";q.height=this.tmpdiv.lastChild.offsetHeight+"px";this.tmpdiv.removeChild(this.tmpdiv.lastChild)}var e=tyz.PX(q.width)-this.defaultFS+tyz.PX(q.paddingLeft)*1+tyz.PX(q.paddingRight)*1+tyz.PX(q.borderLeftWidth)*1+tyz.PX(q.borderRightWidth)*1;if(e!=0){e=(e*1+tyz.PX(q.width)*1)/2;this.mR=this.mR*1>e*1?this.mR:tyz.floor(e,2)}this.currentH=this.currentH*1+tyz.PX(q.height)*1+tyz.PX(q.paddingTop)*1+tyz.PX(q.paddingBottom)*1}else{if(A=="BR"||A=="HR"){return j}else{var B=this.seekNodes(s,j,D,v);if(B){return B}}}}}}}}if(j.nextSibling){var E=j.nextSibling;if(this.isBlock(E)||this.isThru(E)){return j}}}return false},setLineMargin:function(a){if(this.lineW*1<a*1){var c=(a-this.lineW)/2;if(this.mL*1<c*1){this.mL=c}var b=(a-this.lineW)/2;if(this.mR*1<b*1){this.mR=b}}},separatePages:function(c,f){this.tmpdiv.appendChild(f);f.style.positon="absolute";var m=new Array();while(1){var o=tyz.getByClass(f,"h2v_e");var e=f.offsetWidth;if(!o){break}var a=o.length;for(var k=0;k<a;k++){var l=false;var g=e-o[k].offsetLeft+tyz.PX(o[k].style.marginLeft)*1;var n=o[k].parentNode;if(g*1>tyz.PX(this.target[c].pagewidth)*1){if(tyz.getAttr(o[k].parentNode,"class")=="h2v"){if(!o[k].previousSibling){var j=o[k]}else{var j=o[k].previousSibling}}else{if(k!=0){var j=o[k-1];l=this.findSameAncestor(o[k],o[k-1]);var h=l;while(h){if(tyz.getAttr(h,"class")=="h2v"){break}if(tyz.PX(h.style.height)==0){if(this.isIE8){h.style.height=h.offsetHeight-tyz.PX(h.style.paddingTop)-tyz.PX(h.style.paddingBottom)-tyz.PX(h.style.borderTopWidth)-tyz.PX(h.style.borderBottomWidth)+"px"}else{h.style.height=tyz.getStyle(h).height}}h=h.parentNode}}else{var j=o[k]}}m[m.length]=this.extractRange(f,j);var b=m[m.length-1];while(b.lastChild){b=b.lastChild;if((this.isBlock(b)||this.isList(b))&&tyz.getAttr(b,"class")!="h2v_e"){b.style.marginLeft="0px";b.style.paddingLeft="0px";b.style.borderLeftWidth="0px"}if(tyz.getAttr(b,"class")=="h2v_e"){break}}while(l){if(tyz.getAttr(l,"class")=="h2v"){break}if(l.style){l.style.marginRight="0px";l.style.paddingRightt="0px";l.style.borderRightWidth="0px";l=l.parentNode}}break}}if(k==a&&f.hasChildNodes){m[m.length]=this.extractNodeContents(f);break}}return m},isBlock:function(b){for(var a=0;a<this.blocks.length;a++){if(b.nodeName==this.blocks[a]){return true}}return false},isList:function(b){for(var a=0;a<this.lists.length;a++){if(b.nodeName==this.lists[a]){return true}}return false},isInline:function(b){for(var a=0;a<this.inlines.length;a++){if(b.nodeName==this.inlines[a]){return true}}return false},isThru:function(b){for(var a=0;a<this.thrus.length;a++){if(b.nodeName==this.thrus[a]){return true}}return false},rotateProperties:function(a){var k;var f;for(var e=0;e<a.childNodes.length;e++){k=a.childNodes[e];f=k.nodeName;if(this.isBlock(k)||this.isList(k)||this.isInline(k)||(f=="SPAN"&&!/h2v/g.test(tyz.getAttr(k,"class")))||f=="DIV"||this.isThru(k)){if(this.isWKold){var c=k.style.display;k.style.display="inline-block"}var m=tyz.getStyles(k,{fontSize:"",marginTop:"",marginRight:"",marginBottom:"",marginLeft:"",paddingTop:"",paddingRight:"",paddingBottom:"",paddingLeft:"",borderTopStyle:"",borderRightStyle:"",borderBottomStyle:"",borderLeftStyle:""});if(this.isWKold){k.style.display=c}var h=tyz.floor(tyz.PX(m.marginLeft),0)+"px "+tyz.floor(tyz.PX(m.marginTop),0)+"px "+tyz.floor(tyz.PX(m.marginRight),0)+"px "+tyz.floor(tyz.PX(m.marginBottom),0)+"px";var l=tyz.floor(tyz.PX(m.paddingLeft),0)+"px "+tyz.floor(tyz.PX(m.paddingTop),0)+"px "+tyz.floor(tyz.PX(m.paddingRight),0)+"px "+tyz.floor(tyz.PX(m.paddingBottom),0)+"px";var g=this.rotateBorder({Top:m.borderTopStyle,Right:m.borderRightStyle,Bottom:m.borderBottomStyle,Left:m.borderLeftStyle},k);var j={fontSize:tyz.floor(tyz.PX(m.fontSize),1)+"px",margin:h,padding:l};for(var b in g){j[b]=g[b]}tyz.setStyles(k,j);this.rotateProperties(k)}}},rotateBorder:function(a,g){var f={};for(var h in a){if(a[h]&&a[h]!="none"){f["border"+c(h)+"Style"]=a[h];var b={};b["border"+h+"Width"]="";b["border"+h+"Color"]="";var e=tyz.getStyles(g,b);f["border"+c(h)+"Width"]=e["border"+h+"Width"];f["border"+c(h)+"Color"]=e["border"+h+"Color"]}else{f["border"+c(h)+"Style"]="none";f["border"+c(h)+"Width"]="0"}}return f;function c(j){var i={Top:"Right",Right:"Bottom",Bottom:"Left",Left:"Top"};return i[j]}},getDisplayedStyle:function(a,b,h){var i=a.cloneNode(h);var e=a.parentNode;var g=0;while(e&&e.nodeName!="#document-fragment"){var f=e.cloneNode(false);f.appendChild(i);i=f;g++;e=e.parentNode}this.tmpdiv.appendChild(i.cloneNode(true));var k=this.tmpdiv.lastChild;for(d=0;d<g;d++){k=k.lastChild}var c=b;for(var j in c){c[j]=tyz.getStyle(k)[j]}this.tmpdiv.removeChild(this.tmpdiv.lastChild);return c},createTmpdiv:function(c){if(!tyz.getById("h2v_tmp_div")){var b=this.target[c].originalHeight*1.5*tyz.PX(this.target[c].fontsize)/tyz.PX(this.target[c].originalFontSize);b=b*1+tyz.getById(c).offsetWidth*1.5;b=tyz.round(b,0);var a=tyz.newEle("DIV",{id:"h2v_tmp_div","class":"h2v"},{position:"absolute",top:"0px",left:"0px",width:b+"px",visibility:"hidden"});tyz.getById(c).appendChild(a);return a}else{return tyz.getById("h2v_tmp_div")}},removeTmpdiv:function(a){if(tyz.getById("h2v_tmp_div")){tyz.getById("h2v_tmp_div").parentNode.removeChild(tyz.getById("h2v_tmp_div"))}},h2v:function(f,g){this.id=g;var c=f[g];var e=h2vconvert;this.auto=b("auto");this.bar=b("bar");this.showcredit=b("showcredit");this.chars=b("chars");this.fontsize=b("fontsize");this.lineInterval=b("lineInterval");this.pagewidth=b("pagewidth");if(c.bar===undefined&&c.recovery!==undefined){this.bar=c.recovery}if(e.isIE8){this.fontsize=e.ieFontValue(this.fontsize)}var a=tyz.getById(g).offsetWidth-tyz.getPxStyle(g,"paddingLeft")-tyz.getPxStyle(g,"paddingRight")-tyz.getPxStyle(g,"borderLeftWidth")-tyz.getPxStyle(g,"borderRightWidth");this.pagewidth=c.pagewidth!==undefined?c.pagewidth:(a+"px");if(tyz.PX(this.pagewidth)>a){this.pagewidth=a+"px"}this.original=tyz.getById(this.id).innerHTML;this.originalFontFamily=tyz.getStyle(g).fontFamily;this.originalFontSize=tyz.getStyle(g).fontSize;if(e.isIE8){this.originalFontSize=e.ieFontValue(this.originalFontSize)}this.originalHeight=tyz.getById(g).offsetHeight;tyz.getById(g).style.fontFamily=e.defaultFontFamily;tyz.getById(g).style.fontSize=this.fontsize;this.html=tyz.getById(this.id).innerHTML;this.converted="";function b(h){return c[h]!==undefined?c[h]:e.defaultval[h]}},addVTags:function(c){var o;var k;for(var h=c.childNodes.length-1;h>=0;h--){o=c.childNodes[h];k=o.nodeName;if(k=="#text"){var r=o.nodeValue;var m=RegExp("(["+this.komojis+"])|(["+this.chos+"])|(["+this.kutos+"])|(\\s)|([!-~]+\\s?)|(["+this.kakkos+"])","g");var s=new Array();var l=new Array();var f=new Array();var q=new Array();while(s=m.exec(r)){if(s[1]){l[l.length]="h2v_komoji"}else{if(s[2]){l[l.length]="h2v_cho"}else{if(s[3]){l[l.length]="h2v_kuto"}else{if(s[4]){l[l.length]="h2v_sp"}else{if(s[5]){l[l.length]="h2v_alpha"}else{if(s[6]){l[l.length]="h2v_kakko"}}}}}}q[q.length]=s[0].length;f[f.length]=m.lastIndex-s[0].length}var a;for(var g=l.length-1;g>=0;g--){var p=o.splitText(f[g]+q[g]);var e=o.splitText(f[g]);var a=tyz.newEle("SPAN",{"class":l[g]});if(this.isIE8){if(l[g]=="h2v_cho"){tyz.setStyles(a,{filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1, mirror=1)",fontFamily:"'ＭＳ ゴシック','MS Gothic' , monospace"})}if(l[g]=="h2v_kakko"){tyz.setStyles(a,{filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)",fontFamily:"'ＭＳ ゴシック','MS Gothic' , monospace"})}}var n=e.nodeValue;var b=document.createTextNode(n);a.appendChild(b);o.parentNode.replaceChild(a,e)}}else{if(this.isBlock(o)||this.isList(o)||this.isInline(o)||o.nodeName=="SPAN"){this.addVTags(o)}}}},findSameAncestor:function(e,b){var c=e;var a=false;while(c.parentNode){c=c.parentNode;if(tyz.getAttr(c,"class")=="h2v"){break}if(this.isIE8){a=c.contains(b);if(a){break}}else{var f=c.compareDocumentPosition(b);a=f&c.DOCUMENT_POSITION_CONTAINED_BY;if(a){break}}}if(a){return c}return false},extractRange:function(c,g){var f=document.createDocumentFragment();while(1){var b=c.firstChild;if(!b){break}if(b===g){f.appendChild(c.removeChild(b));break}var e=false;if(this.isIE8){if(b.nodeName!="#text"){var h=g;if(h.nodeName=="#text"){h=h.parentNode;if(h.nodeName=="#document-fragment"){e=false}else{e=b.contains(h)}}else{e=b.contains(h)}}}else{var i=b.compareDocumentPosition(g);e=i&b.DOCUMENT_POSITION_CONTAINED_BY}if(e){f.appendChild(b.cloneNode(false));var a=this.extractRange(b,g);f.lastChild.appendChild(a);if(b.childNodes.length==0){c.removeChild(b)}break}else{f.appendChild(c.removeChild(b))}}return f},extractNodeContents:function(c){var b=document.createDocumentFragment();while(1){var a=c.firstChild;if(!a){break}b.appendChild(c.removeChild(a))}return b},switcher:function(c){var b=this.target[c];var a=tyz.getById(c);if(tyz.getByClass(a,"h2v").length){a.style.fontSize=b.originalFontSize;a.style.fontFamily=b.originalFontFamily;a.innerHTML=b.original}else{if(!b.pages){this.convert(c)}else{a.style.fontFamily=this.defaultFontFamily;a.style.fontSize=b.fontsize;this.extractNodeContents(a);a.appendChild(b.pages.cloneNode(true));a.appendChild(tyz.newEle("DIV",{"class":"clearfix"}))}}},ieFontValue:function(a){switch(a){case"xx-small":return"9px";case"x-small":return"10px";case"small":return"13px";case"medium":return"16px";case"large":return"18px";case"x-large":return"24px";case"xx-large":return"32px";default:return a}},komojis:Array("ぁ","ぃ","ぅ","ぇ","ぉ","っ","ゃ","ゅ","ょ","ゎ","ァ","ィ","ゥ","ェ","ォ","ッ","ャ","ュ","ョ","ヮ").join(""),kakkos:Array("「","」","『","』","（","）","［","］","｛","｝","〈","〉","《","》","〔","〕","【","】","＜","＞","↑","↓").join(""),chos:Array("ー","〜","～","…","−","—","＝","→","←","：","；").join(""),kutos:Array("。","、","，").join("")};var tyz={examType:function(a){return typeof(a)=="object"?a:this.getById(a)},getByClass:function(g,a){var e=this.examType(g);if(e.getElementsByClassName){return e.getElementsByClassName(a)}else{var f=tyz.getByTag(e,"*");var b=new Array();for(var c=0;c<f.length;c++){if(tyz.getAttr(f[c],"class")==a){b[b.length]=f[c]}}return b}},getById:function(a){return document.getElementById(a)},getByTag:function(c,a){var b=this.examType(c);return b.getElementsByTagName(a)},getStyle:function(b){var a=this.examType(b);if(h2vconvert.isIE8){return a.currentStyle}return document.defaultView.getComputedStyle(a,null)},getStyles:function(e,f){var c=this.examType(e);var b=c.currentStyle||document.defaultView.getComputedStyle(c,null);if(h2vconvert.isOpera){b=document.defaultView.getComputedStyle(c,null)}for(var a in f){f[a]=b[a]}return f},getAttr:function(c,a){var b=this.examType(c);if(a=="class"&&h2vconvert.isIE8){return b.className||""}return b.getAttribute(a)||""},PX:function(a){if(a.match("px")){return a.replace("px","")}if(a.match("pt")){return a.replace("pt","")*4/3}if(a.match("em")){return a.replace("em","")*h2vconvert.defaultFS}if(a.match(/[^0-9\.]/g)){return 0}return this.ceil(a,2)},getPxStyle:function(c,f){var b=this.examType(c);var a=b.currentStyle||document.defaultView.getComputedStyle(b,null);if(h2vconvert.isOpera){a=document.defaultView.getComputedStyle(b,null)}var e=a[f];return this.PX(e)},setStyles:function(e,b){var c=this.examType(e);for(var a in b){c.style[a]=b[a]}return c},newEle:function(f,c,h){var i=document.createElement(f);for(var b in c){if(h2vconvert.isIE8&&b=="class"){i.className=c[b]}else{i.setAttribute(b,c[b])}}for(var g in h){var e=g;if(e=="float"){e=h2vconvert.isIE8?"styleFloat":"cssFloat"}i.style[e]=h[g]}return i},ceil:function(b,a){return Math.ceil(b*Math.pow(10,a))/Math.pow(10,a)},floor:function(b,a){return Math.floor(b*Math.pow(10,a))/Math.pow(10,a)},round:function(b,a){return Math.round(b*Math.pow(10,a))/Math.pow(10,a)}};